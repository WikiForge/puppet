# NOTE: This file is managed by Puppet.

$DefaultNetstreamDriverCAFile /etc/ssl/certs/ISRG_Root_X1.pem
$DefaultNetstreamDriverCertFile /etc/ssl/localcerts/inside.wf.crt
$DefaultNetstreamDriverKeyFile /etc/ssl/private/inside.wf.key

if ($syslogseverity-text == 'info' and
    $syslogfacility-text != 'cron' and
    $syslogfacility-text != 'authpriv' and
    $syslogfacility-text != 'mail') then {
  action(type="omfwd" name="fwd_graylog1.inside.wf" Target="graylog1.inside.wf" Port="12210"
    StreamDriver="ossl" StreamDriverAuthMode="x509/certvalid" StreamDriverMode="1"
    Protocol="tcp"  template="RSYSLOG_SyslogProtocol23Format"
    action.resumeRetryCount="-1"
  <%- if @syslog_queue_size > 0 -%>
    queue.type="LinkedList" queue.size="<%= @syslog_queue_size %>" queue.filename="fwd_graylog1.inside.wf"
    queue.highWatermark="<%= (@syslog_queue_size * 0.7).to_i %>" queue.lowWatermark="<%= (@syslog_queue_size * 0.6).to_i %>"
    queue.checkpointInterval="5"
    queue.saveonshutdown="on"
  <%- end -%>
    )
}
